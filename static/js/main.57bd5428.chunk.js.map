{"version":3,"sources":["components/logo.svg","components/Header.js","components/Footer.js","components/Loading.js","App.js","index.js","models/index.js","stores/user.js","stores/history.js","stores/image.js","stores/auth.js","stores/index.js"],"names":["Header","styled","header","Logo","img","StyledLink","NavLink","Login","div","StyledButton","Button","Component","observer","useStores","UserStore","AuthStore","ImgStore","navigate","useNavigate","src","LogoUrl","alt","to","activeclassname","currentUser","attributes","username","type","onClick","serverFile","logout","Loading","Home","React","lazy","History","About","Register","App","fallback","path","element","Footer","ReactDOM","render","document","getElementById","AV","init","appId","appKey","serverURL","Auth","password","user","User","setUsername","setPassword","Promise","resolve","reject","signUp","then","err","logIn","logOut","current","Uploader","add","filename","file","item","Object","imgFile","File","set","save","find","page","limit","query","Query","equalTo","skip","descending","result","catch","window","makeObservable","this","observable","action","list","isLoading","hasMore","makeAutoObservable","newList","concat","console","log","append","length","message","error","finally","newFilename","newFile","isUploading","setServerFile","setIsUploading","values","pullUser","resetUser","HistoryStore","reset","context","createContext","store","useContext"],"mappings":"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","file":"static/js/main.57bd5428.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import React from \"react\";\nimport LogoUrl from './logo.svg';\nimport { NavLink, useNavigate } from 'react-router-dom';\nimport styled from 'styled-components';\nimport { Button } from 'antd';\nimport { useStores } from '../stores/index';\nimport { observer } from 'mobx-react';\n\nconst Header = styled.header`\n  display: flex;\n  color: white;\n  align-items: center;\n  padding: 10px 100px;\n  background-color: #02101f;\n`;\nconst Logo = styled.img`\n  height: 30px;\n`;\nconst StyledLink = styled(NavLink)`\n color: #fff;\n margin-left: 30px;\n\n &.active {\n   border-bottom: 1px solid #fff;\n }\n`;\nconst Login = styled.div`\n  margin-left: auto;\n`;\nconst StyledButton = styled(Button)`\n  margin: 10px;\n`\n\nconst Component = observer(() => {\n  const { UserStore, AuthStore, ImgStore } = useStores();\n  const navigate = useNavigate();\n\n  const handleLogin = () => {\n    navigate('/login');\n  };\n  const handleLogout = () => {\n    ImgStore.serverFile = null;\n    AuthStore.logout();\n  };\n  const handleRegister = () => {\n    navigate('/register');\n  };\n\n  return (\n    <Header>\n      <Logo src={LogoUrl} alt='logo' />\n      <nav>\n        <StyledLink to='/' activeclassname='active'>首页</StyledLink>\n        <StyledLink to='/history' activeclassname='active'>上传历史</StyledLink>\n        <StyledLink to='/about' activeclassname='active'>关于我</StyledLink>\n      </nav>\n      <Login>\n        {\n          UserStore.currentUser ?\n            <>\n              {UserStore.currentUser.attributes.username}<StyledButton type='primary' onClick={handleLogout}>注销</StyledButton>\n            </> :\n            <>\n              <StyledButton type='primary' onClick={handleLogin}>登陆</StyledButton>\n              <StyledButton type='primary' onClick={handleRegister}>注册</StyledButton>\n            </>\n        }\n      </Login>\n    </Header >\n  );\n})\n\n\nexport default Component","import React from \"react\";\nimport styled from 'styled-components';\n\nconst Header = styled.header`\n  height: 60px;\n  padding: 10px 100px;\n  background-color: #02101f;\n`;\n\nconst Component = () => {\n  return <Header />\n}\n\nexport default Component","import React from \"react\";\n\nfunction Loading (){\n  return (\n    <h1>Loading...</h1>\n  )\n}\n\nexport default Loading","import React, { Suspense } from 'react'\nimport Header from './components/Header';\nimport Footer from './components/Footer';\nimport Loading from './components/Loading';\nimport { Routes, Route } from 'react-router-dom';\nimport './App.css'\n\nconst Home = React.lazy(() => import('./pages/Home.js'))\nconst History = React.lazy(() => import('./pages/History.js'))\nconst About = React.lazy(() => import('./pages/About.js'))\nconst Login = React.lazy(() => import('./pages/Login.js'))\nconst Register = React.lazy(() => import('./pages/Register.js'))\n\n\nfunction App() {\n  return (\n    <>\n      <Header />\n      <main>\n        <Suspense fallback={<Loading />}>\n          <Routes>\n            <Route path='/' element={<Home />}></Route>\n            <Route path='/history' element={<History />}></Route>\n            <Route path='/about' element={<About />}></Route>\n            <Route path='/login' element={<Login />}></Route>\n            <Route path='/register' element={<Register />}></Route>\n          </Routes>\n        </Suspense>\n      </main>\n      <Footer />\n    </>\n  );\n}\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport 'antd/dist/antd.css';\nimport { HashRouter } from 'react-router-dom';\n\n\nReactDOM.render(\n  <HashRouter>\n    <App />\n  </HashRouter>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n\n","import AV from 'leancloud-storage'\n\nAV.init({\n  appId: \"RgIcSghc2maGPxftcphxI2cD-9Nh9j0Va\",\n  appKey: \"kunEh33HRS5pchvay8Jh50fr\",\n  serverURL: \"https://rgicsghc.lc-cn-e1-shared.com\"\n});\n\nconst Auth = {\n  register(username, password) {\n    let user = new AV.User();\n    user.setUsername(username)\n    user.setPassword(password)\n    return new Promise((resolve, reject) => {\n      user.signUp().then(user => resolve(user), err => reject(err))\n    });\n  },\n  login(username, password) {\n    return new Promise((resolve, reject) => {\n      AV.User.logIn(username, password).then((user) => resolve(user), (err) => reject(err));\n    });\n  },\n  logout() {\n    AV.User.logOut();\n  },\n  getCurrentUser() {\n    return AV.User.current();\n  }\n}\n\nconst Uploader = {\n  add(filename, file) {\n    const item = new AV.Object('Image');\n    const imgFile = new AV.File(filename, file)\n    item.set('filename', filename);\n    item.set('owner', AV.User.current());\n    item.set('url', imgFile);\n    return new Promise((resolve, reject) => {\n      item.save().then(serverFile => {\n        resolve(serverFile);\n      }, err => reject(err));\n    });\n  },\n  find( page=0,limit=10 ) {\n    const query = new AV.Query('Image');\n    query.equalTo('owner', AV.User.current());\n    query.limit(limit);\n    query.skip(page * limit);\n    query.descending('createAt');\n    return new Promise((resolve, reject) => {\n      query.find()\n        .then(result => resolve(result))\n        .catch(err => reject(err))\n    })\n  },\n}\n\nwindow.Uploader = Uploader;\n\nexport {\n  Auth,\n  Uploader\n}","// 用户信息存储\nimport { makeObservable, observable, action } from 'mobx';\nimport { Auth } from '../models/index'\n\n\nclass UserStore {\n\n  @observable currentUser = null;\n\n  constructor() {\n    makeObservable(this);\n  }\n  @action pullUser() {\n    this.currentUser = Auth.getCurrentUser()\n  }\n  @action resetUser() {\n    this.currentUser = null;\n  }\n}\n\nexport default new UserStore()","import { makeAutoObservable } from \"mobx\";\nimport { Uploader } from '../models/index';\nimport { message } from 'antd';\n\nclass HistoryStore {\n  list = [];\n  isLoading = false;\n  hasMore = true;\n  page = 0;\n  limit = 10;\n\n  constructor() {\n    makeAutoObservable(this);\n  }\n\n  append(newList) {\n    this.list = this.list.concat(newList);\n  }\n  find() {\n    console.log('history store find()')\n    this.isLoading = true;\n    Uploader.find(this.page, this.limit)\n      .then(newList => {\n        this.append(newList);\n        this.page++;\n        if (newList.length < this.limit) {\n          this.hasMore = false;\n        }\n      }).catch(err => {\n        message.error('加载失败')\n      }).finally(() => {\n        this.isLoading = false;\n      })\n  }\n  reset() {\n    this.list = [];\n    this.isLoading = false;\n    this.hasMore = true;\n    this.page = 0;\n  }\n}\nexport default new HistoryStore()","// 登陆注册\nimport { makeObservable, observable, action } from 'mobx';\nimport { Uploader } from '../models/index';\n\n\n\nclass ImgStore {\n\n  @observable filename = '';\n  @observable file = null;\n  @observable isUploading = false;\n  @observable serverFile = null;\n\n  constructor() {\n    makeObservable(this);\n  }\n\n  @action setFilename(newFilename) {\n    this.filename = newFilename;\n  }\n  @action setFile(newFile) {\n    this.file = newFile\n  }\n  @action setServerFile(newFile) {\n    this.serverFile = newFile\n  }\n  @action setIsUploading(type) {\n    this.isUploading = type\n  }\n  @action upload() {\n    this.setServerFile(null);\n    this.setIsUploading(true);\n    return new Promise((resolve, reject) => {\n      Uploader.add(this.filename, this.file)\n        .then(serverFile => {\n          this.setServerFile(serverFile)\n          resolve(serverFile);\n        }).catch(err => {\n          reject(err);\n        }).finally(() => {\n          this.isUploading = false;\n        })\n    })\n  }\n  @action reset() {\n    this.filename = '';\n    this.file = null;\n    this.isUploading = false;\n    this.serverFile = null;\n  }\n}\n\nexport default new ImgStore()","// 登陆注册\nimport { makeObservable, observable, action } from 'mobx';\nimport { Auth } from '../models/index';\nimport UserStore from './user';\nimport HistoryStore from './history';\nimport ImgStore from './image'\n\n\nclass AuthStore {\n\n  @observable values = {\n    username: '',\n    password: ''\n  };\n  constructor() {\n    makeObservable(this)\n  }\n  @action setUsername(username) {\n    this.values.username = username;\n  }\n  @action setPassword(password) {\n    this.values.password = password;\n  }\n  @action login() {\n    return new Promise((resolve, reject) => {\n      Auth.login(this.values.username, this.values.password)\n        .then(user => {\n          UserStore.pullUser();\n          resolve(user);\n        }).catch(err => {\n          UserStore.resetUser();\n          reject(err);\n        })\n    })\n  }\n  @action register() {\n    return new Promise((resolve, reject) => {\n      Auth.register(this.values.username, this.values.password)\n        .then(user => {\n          UserStore.pullUser();\n          resolve(user);\n        }).catch(err => {\n          UserStore.resetUser();\n          reject(err);\n        })\n    })\n  }\n  @action logout() {\n    Auth.logout();\n    UserStore.resetUser();\n    HistoryStore.reset();\n    ImgStore.reset();\n  }\n}\n\nexport default new AuthStore()","// 总入口\nimport { createContext, useContext } from \"react\";\nimport AuthStore from './auth';\nimport UserStore from './user';\nimport ImgStore from './image';\nimport HistoryStore from './history';\n\nconst context = createContext({\n  AuthStore,\n  UserStore,\n  ImgStore,\n  HistoryStore\n});\nwindow.store = {\n  AuthStore,\n  UserStore,\n  ImgStore,\n  HistoryStore\n}\n\nexport const useStores = () => useContext(context)"],"sourceRoot":""}