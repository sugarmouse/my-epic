{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Result","styled","div","H1","h1","Image","img","Component","observer","useStores","UserStore","ImgStore","Dragger","Upload","refWidth","useRef","refHeight","store","useLocalStore","width","setWidth","height","setHeight","serverFile","attributes","url","widthStr","heightStr","props","showUploadList","beforeUpload","file","setFile","setFilename","name","currentUser","message","warning","test","type","size","error","upload","then","info","catch","err","tip","spinning","isUploading","className","InboxOutlined","target","rel","href","filename","src","alt","ref","onChange","current","value","placeholder","thumbnailImgUrl","Warning","Hello","SayHello","username","Home","Tips","Uploader"],"mappings":"iOAQMA,EAASC,IAAOC,IAAV,+FAKNC,EAAKF,IAAOG,GAAV,sEAIFC,EAAQJ,IAAOK,IAAV,iDA4GIC,EAxGGC,aAAS,WAAO,IAAD,EACCC,cAAxBC,EADuB,EACvBA,UAAWC,EADY,EACZA,SACXC,EAAYC,IAAZD,QACFE,EAAWC,mBACXC,EAAYD,mBAIZE,EAAQC,aAAc,iBAAO,CACjCC,MAAO,KACPC,SAFiC,SAExBD,GACPF,EAAME,MAAQA,GAEhB,eACE,OAAOF,EAAME,MAAN,aAAoBF,EAAME,OAAU,IAG7CE,OAAQ,KACRC,UAViC,SAUvBD,GACRJ,EAAMI,OAASA,GAEjB,gBACE,OAAOJ,EAAMI,OAAN,aAAqBJ,EAAMI,QAAW,IAE/C,sBACE,OAAOV,EAASY,WAAWC,WAAWC,IAAID,WAAWC,IAAM,eAAiBR,EAAMS,SAAWT,EAAMU,UAAY,yBAU7GC,EAAQ,CACZC,gBAAgB,EAChBC,aAAc,SAAAC,GAGZ,OAFApB,EAASqB,QAAQD,GACjBpB,EAASsB,YAAYF,EAAKG,MACI,OAA1BxB,EAAUyB,aACZC,IAAQC,QAAQ,+CACT,GAEJ,wCAAwCC,KAAKP,EAAKQ,MAInDR,EAAKS,KAAO,SACdJ,IAAQK,MAAM,wDACP,IAGT9B,EAAS+B,SACNC,MAAK,SAACpB,GACLa,IAAQQ,KAAK,2CACZC,OAAM,SAAAC,GACPV,IAAQK,MAAM,4CAEX,IAdLL,IAAQK,MAAM,4EACP,KAiBb,OACE,gCACE,cAAC,IAAD,CAAMM,IAAI,qBAAMC,SAAUrC,EAASsC,YAAnC,SACE,eAACrC,EAAD,2BAAagB,GAAb,cACE,mBAAGsB,UAAU,uBAAb,SACE,cAACC,EAAA,EAAD,MAEF,mBAAGD,UAAU,kBAAb,0EACA,mBAAGA,UAAU,kBAAb,oHAOFvC,EAASY,WAAa,eAACvB,EAAD,WACpB,cAACG,EAAD,uCACA,+BACE,0DACA,6BAAI,mBAAGiD,OAAO,SAASC,IAAI,aAAaC,KAAM3C,EAASY,WAAWC,WAAWC,IAAID,WAAWC,IAAxF,SAA8Fd,EAASY,WAAWC,WAAWC,IAAID,WAAWC,QAChJ,oDACA,6BAAKd,EAAS4C,WACd,0DACA,6BACE,cAAClD,EAAD,CAAOmD,IAAK7C,EAASY,WAAWC,WAAWC,IAAID,WAAWC,IAAKgC,IAAI,+BAErE,8CACA,+BACE,uBAAOC,IAAK5C,EAAU6C,SA/DV,WACtB1C,EAAMG,SAASN,EAAS8C,QAAQC,QA8D2BC,YAAY,qDAC7D,uBAAOJ,IAAK1C,EAAW2C,SA7DV,WACvB1C,EAAMG,SAASJ,EAAU4C,QAAQC,QA4D4BC,YAAY,wDAEjE,6BAAI,mBAAGV,OAAO,SAASC,IAAI,aAAaC,KAAMrC,EAAM8C,gBAAhD,SAAkE9C,EAAM8C,0BAEpE,WChHdC,EAAU/D,IAAOC,IAAV,+HAOP+D,EAAQhE,IAAOC,IAAV,gIAQLgE,EAAW1D,aAAS,WAAK,IACrBE,EAAcD,cAAdC,UACR,OACE,eAACuD,EAAD,oBAAcvD,EAAUyB,YAAYX,WAAW2C,eAapC5D,EATGC,aAAS,WAAO,IACxBE,EAAcD,cAAdC,UACR,OACE,mCACGA,EAAUyB,YAAY,cAAC+B,EAAD,IAAY,cAACF,EAAD,+DCzBnCI,EAAO5D,aAAS,WACpB,OACE,qCACE,cAAC6D,EAAD,IACA,cAACC,EAAD,UAISF","file":"static/js/9.6613ab12.chunk.js","sourcesContent":["import React, { useRef } from 'react';\nimport { useStores } from '../stores/index';\nimport { observer, useLocalStore } from 'mobx-react';\nimport { Upload, message, Spin } from 'antd';\nimport { InboxOutlined } from '@ant-design/icons';\nimport styled from 'styled-components';\n\n\nconst Result = styled.div`\n  margin-top: 30px;\n  border: 1px dashed #ccc;\n  padding: 20px;\n`;\nconst H1 = styled.h1`\n  margin: 20px 0;\n  text-align: center;\n`;\nconst Image = styled.img`\n  max-width: 300px;\n`;\n\nconst Component = observer(() => {\n  const { UserStore, ImgStore } = useStores();\n  const { Dragger } = Upload;\n  const refWidth = useRef();\n  const refHeight = useRef();\n\n\n\n  const store = useLocalStore(() => ({\n    width: null,\n    setWidth(width) {\n      store.width = width;\n    },\n    get widthStr() {\n      return store.width ? `/w/${store.width}` : '';\n    },\n\n    height: null,\n    setHeight(height) {\n      store.height = height;\n    },\n    get heightStr() {\n      return store.height ? `/h/${store.height}` : '';\n    },\n    get thumbnailImgUrl() {\n      return ImgStore.serverFile.attributes.url.attributes.url + '?imageView/2' + store.widthStr + store.heightStr + '/q/100/format/png'\n    }\n  }))\n  const bindWidthChange = () => {\n    store.setWidth(refWidth.current.value)\n  }\n  const bindHeightChange = () => {\n    store.setWidth(refHeight.current.value)\n  }\n\n  const props = {\n    showUploadList: false,\n    beforeUpload: file => {\n      ImgStore.setFile(file);\n      ImgStore.setFilename(file.name);\n      if (UserStore.currentUser === null) {\n        message.warning('请先登陆再上传');\n        return false;\n      }\n      if (!/(png$)|(svg$)|(jpg$)|(jpeg$)|(gif$)/ig.test(file.type)) {\n        message.error('只能上传 svg/png/jpg/gif 格式的图片')\n        return false;\n      }\n      if (file.size > 1024 * 1024) {\n        message.error('文件大小不能超过 1M');\n        return false;\n      }\n      // 增加文件类型、文件大小判断\n      ImgStore.upload()\n        .then((serverFile) => {\n          message.info('图片上传成功')\n        }).catch(err => {\n          message.error('图片上传失败')\n        });\n      return false;\n    }\n  };\n\n  return (\n    <div>\n      <Spin tip='上传中' spinning={ImgStore.isUploading}>\n        <Dragger {...props}>\n          <p className=\"ant-upload-drag-icon\">\n            <InboxOutlined />\n          </p>\n          <p className=\"ant-upload-text\">点击或者拖拽上传图片</p>\n          <p className=\"ant-upload-hint\">\n            仅支持 .png/.gif/.jpg/.svg 格式图片，图片最大 1M\n          </p>\n        </Dragger>\n      </Spin>\n\n      {\n        ImgStore.serverFile ? <Result>\n          <H1>上传结果</H1>\n          <dl>\n            <dt>线上地址</dt>\n            <dd><a target='_blank' rel=\"noreferrer\" href={ImgStore.serverFile.attributes.url.attributes.url}>{ImgStore.serverFile.attributes.url.attributes.url}</a></dd>\n            <dt>文件名</dt>\n            <dd>{ImgStore.filename}</dd>\n            <dt>文件预览</dt>\n            <dd>\n              <Image src={ImgStore.serverFile.attributes.url.attributes.url} alt=\"加载失败\" />\n            </dd>\n            <dt>尺寸</dt>\n            <dd>\n              <input ref={refWidth} onChange={bindWidthChange} placeholder=\"最大宽度（可选）\" />\n              <input ref={refHeight} onChange={bindHeightChange} placeholder=\"最大高度（可选）\" />\n            </dd>\n            <dd><a target='_blank' rel=\"noreferrer\" href={store.thumbnailImgUrl}>{store.thumbnailImgUrl}</a></dd>\n          </dl>\n        </Result> : null\n      }\n    </div>\n\n  );\n})\n\n\nexport default Component","import React from 'react';\nimport { useStores } from '../stores/index';\nimport { observer } from 'mobx-react';\nimport styled from 'styled-components';\n\nconst Warning = styled.div`\n  background: orange;\n  padding: 10px;\n  margin: 10px 0;\n  color: #fff;\n  border-radius: 4px;\n`;\nconst Hello = styled.div`\n  background: #0073bf;\n  padding: 10px;\n  margin: 10px 0;\n  color: #fff;\n  border-radius: 4px;\n`;\n\nconst SayHello = observer(()=>{\n  const { UserStore } = useStores();\n  return (\n    <Hello>Hello {UserStore.currentUser.attributes.username}</Hello>\n  )\n})\n\nconst Component = observer(() => {\n  const { UserStore } = useStores();\n  return(\n    <>\n      {UserStore.currentUser?<SayHello/>:<Warning>请先登陆再上传 </Warning>}\n    </>\n  )\n});\n\nexport default Component;\n\n// return (\n//     <>\n//     {UserStore.currentUser ? <Hello>Hello {UserStore.currentUser.attributes.username}<Hello /> : <Warning>请先登陆再上传 </Warning>}\n//     </>\n//   );","import React from \"react\";\nimport { observer } from 'mobx-react';\n// import { useStores } from '../stores/index';\nimport Uploader from '../components/Uploader';\nimport Tips from '../components/Tips'\n\nconst Home = observer(() => {\n  return (\n    <>\n      <Tips />\n      <Uploader />\n    </>\n  )\n})\nexport default Home"],"sourceRoot":""}